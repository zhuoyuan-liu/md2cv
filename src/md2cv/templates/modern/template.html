<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<style>
  @page {
    size: {{ style.page_width }} {{ style.page_height }};
    margin: {{ style.margin_top }}mm {{ style.margin_right }}mm {{ style.margin_bottom }}mm {{ style.margin_left }}mm;
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: {{ style.base_font_size }}pt;
    line-height: {{ style.line_height }};
    color: #2a2a2a;
  }

  /* ── Header ─────────────────────────────────────────── */

  .header {
    display: flex;
    align-items: center;
    gap: 14pt;
    margin-bottom: {{ style.section_gap }}pt;
    padding-bottom: {{ style.entry_gap }}pt;
    border-bottom: 2pt solid #1e3a5f;
  }

  .photo {
    width: 75px;
    height: 75px;
    border-radius: 50%;
    object-fit: cover;
    flex-shrink: 0;
  }

  .header-text {
    flex: 1;
  }

  .name {
    font-size: {{ style.name_font_size }}pt;
    font-weight: 700;
    color: #1a1a1a;
    letter-spacing: 0.3pt;
    line-height: 1.1;
  }

  .subtitle {
    font-size: {{ style.base_font_size * 1.05 }}pt;
    color: #555;
    margin-top: 2pt;
    margin-bottom: 4pt;
    font-style: italic;
  }

  .contact {
    font-size: {{ style.contact_font_size }}pt;
    color: #555;
  }

  .contact-item {
    white-space: nowrap;
  }

  .contact-item svg {
    vertical-align: -1.8pt;
    margin-right: 2pt;
  }

  .contact-sep {
    color: #bbb;
    margin: 0 3pt;
  }

  /* ── Section headings ────────────────────────────────── */

  .section {
    margin-bottom: {{ style.section_gap }}pt;
  }

  .section-heading {
    font-size: {{ style.heading_font_size }}pt;
    font-weight: 700;
    color: #1e3a5f;
    border-bottom: 1.5pt solid #1e3a5f;
    padding-bottom: 1.5pt;
    margin-bottom: {{ style.entry_gap }}pt;
    text-transform: uppercase;
    letter-spacing: 1.2pt;
  }

  /* ── Entries ─────────────────────────────────────────── */

  .entry {
    margin-bottom: {{ style.entry_gap }}pt;
  }

  .entry-header {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
  }

  .entry-title {
    font-weight: 700;
    color: #1a1a1a;
  }

  .entry-date {
    color: #777;
    font-size: {{ style.base_font_size * 0.9 }}pt;
    white-space: nowrap;
    flex-shrink: 0;
    margin-left: 8pt;
  }

  .entry-org {
    color: #555;
    font-style: italic;
    margin-top: 1pt;
    font-size: {{ style.base_font_size * 0.95 }}pt;
  }

  .entry-tags {
    color: #2563eb;
    font-style: italic;
    font-size: {{ style.base_font_size * 0.88 }}pt;
    margin-top: 1.5pt;
  }

  .entry-description {
    color: #444;
    font-size: {{ style.base_font_size * 0.93 }}pt;
    margin-top: 2pt;
    margin-bottom: 1pt;
  }

  .entry-details {
    margin-top: {{ style.detail_gap }}pt;
    padding-left: 14pt;
  }

  .entry-details li {
    margin-bottom: {{ style.detail_gap }}pt;
  }

  /* ── Raw content (About Me, Skills, etc.) ────────────── */

  .raw-content {
    margin-top: {{ style.detail_gap }}pt;
  }

  .raw-content p {
    margin-bottom: {{ style.detail_gap }}pt;
  }

  .raw-content ul, .raw-content ol {
    padding-left: 14pt;
    margin-bottom: {{ style.detail_gap }}pt;
  }

  .raw-content li {
    margin-bottom: {{ style.detail_gap * 0.5 }}pt;
  }

  a {
    color: #2563eb;
    text-decoration: none;
  }
</style>
</head>
<body>

  <!-- Header -->
  <div class="header">
    {% if photo %}
    <img class="photo" src="data:{{ photo_mime }};base64,{{ photo }}" alt="Photo">
    {% endif %}
    <div class="header-text">
      <div class="name">{{ cv.name }}</div>
      {% if cv.subtitle %}
      <div class="subtitle">{{ cv.subtitle }}</div>
      {% endif %}
      {% if cv.contact.items %}
      <div class="contact">
        {% for item in cv.contact.items %}
        {% if not loop.first %}<span class="contact-sep">|</span>{% endif %}
        <span class="contact-item">
          {% set il = item.lower() %}
          {% if 'phone' in il %}
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="width:8.5pt;height:8.5pt;fill:#555"><path d="M6.6 10.8c1.4 2.8 3.8 5.1 6.6 6.6l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.01L6.6 10.8z"/></svg>
          {% elif 'email' in il or 'mail' in il %}
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="width:8.5pt;height:8.5pt;fill:#555"><path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>
          {% elif 'linkedin' in il %}
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="width:8.5pt;height:8.5pt;fill:#555"><path d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77z"/></svg>
          {% elif 'github' in il %}
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="width:8.5pt;height:8.5pt;fill:#555"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.32.69.94.69 1.88v2.79c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2z"/></svg>
          {% elif 'address' in il or 'location' in il %}
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="width:8.5pt;height:8.5pt;fill:#555"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>
          {% endif %}{{ item.split(': ', 1)[1] if ': ' in item else item }}</span>
        {% endfor %}
      </div>
      {% endif %}
    </div>
  </div>

  <!-- Sections -->
  {% for section in cv.sections %}
  <div class="section">
    <div class="section-heading">{{ section.heading }}</div>

    {% if section.entries %}
      {% for entry in section.entries %}
      <div class="entry">

        <div class="entry-header">
          <span class="entry-title">{{ entry.title }}</span>
          {% if entry.date_range %}
          <span class="entry-date">{{ entry.date_range | replace(' --- ', ' – ') | replace('---', '–') }}</span>
          {% endif %}
        </div>

        {% if entry.organization %}
        <div class="entry-org">{{ entry.organization }}</div>
        {% endif %}

        {% if entry.tags %}
        <div class="entry-tags">{{ entry.tags }}</div>
        {% endif %}

        {% if entry.description %}
        <div class="entry-description">{{ entry.description }}</div>
        {% endif %}

        {% if entry.details %}
        <ul class="entry-details">
          {% for detail in entry.details %}
          <li>{{ detail }}</li>
          {% endfor %}
        </ul>
        {% endif %}

      </div>
      {% endfor %}

    {% elif section.raw_html %}
      <div class="raw-content">{{ section.raw_html }}</div>
    {% endif %}

  </div>
  {% endfor %}

</body>
</html>
